
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Building a Report">
      
      
      
      
        <link rel="prev" href="../building-blocks/">
      
      
        <link rel="next" href="../../misc/view-template-configuration/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Building a Report - Shared Library Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#creating-our-first-table" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Shared Library Documentation" class="md-header__button md-logo" aria-label="Shared Library Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Shared Library Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Building a Report
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="black"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="blue"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../view-menu/" class="md-tabs__link">
          
  
    
  
  View menu

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../styleable-components/" class="md-tabs__link">
          
  
    
  
  Styleable components

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Reports

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../misc/view-template-configuration/" class="md-tabs__link">
          
  
    
  
  Miscellaneous

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Shared Library Documentation" class="md-nav__button md-logo" aria-label="Shared Library Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Shared Library Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../view-menu/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    View menu
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            View menu
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../view-menu/menu-items/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu items
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../view-menu/examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../styleable-components/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Styleable components
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Styleable components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Reports
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reports
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../report-view/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReportView
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../building-blocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building blocks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Building reports
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Building reports
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-our-first-table" class="md-nav__link">
    <span class="md-ellipsis">
      Creating our first table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-example-1" class="md-nav__link">
    <span class="md-ellipsis">
      Production example 1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-example-2" class="md-nav__link">
    <span class="md-ellipsis">
      Production example 2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Production example 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra-content" class="md-nav__link">
    <span class="md-ellipsis">
      Extra content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#individual-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Individual tables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/view-template-configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ViewTemplateConfiguration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/inline-menu-items/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inline Menu Items
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../misc/utility-mixins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utility Mixins
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-our-first-table" class="md-nav__link">
    <span class="md-ellipsis">
      Creating our first table
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-example-1" class="md-nav__link">
    <span class="md-ellipsis">
      Production example 1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#production-example-2" class="md-nav__link">
    <span class="md-ellipsis">
      Production example 2
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Production example 2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extra-content" class="md-nav__link">
    <span class="md-ellipsis">
      Extra content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#individual-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Individual tables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Building reports</h1>

<p>A report is just like any other view in Django. We understandably have to use CBV as the whole report system is built with the approach in mind.</p>
<p>First things first, let's create our view and extend the <code>ReportView</code> class.</p>
<div class="language-Python highlight"><span class="filename">Create view</span><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">class</span> <span class="nc">MyReportView</span><span class="p">(</span><span class="n">ReportView</span><span class="p">):</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="k">pass</span>
</span></code></pre></div>
<p>When we open our view we get an <code>ImproperlyConfigured</code> exception saying <em>ReportMixin requires either a definition of 'report_headline' or an implementation of 'get_report_headline()'</em>. So we have to define our report headline.</p>
<div class="language-Python highlight"><span class="filename">Define headline</span><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">class</span> <span class="nc">MyReportView</span><span class="p">(</span><span class="n">ReportView</span><span class="p">):</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>    <span class="n">headline</span> <span class="o">=</span> <span class="s1">&#39;My fancy report&#39;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>    <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># So we can see the complete barebones report</span>
</span></code></pre></div>
<p><img alt="An empty report" src="../empty_report.png" /></p>
<p>At this stage, our report isn't very useful. Before we get into building tables, we need to familiarize ourselves with the basic building blocks.</p>
<h2 id="creating-our-first-table">Creating our first table</h2>
<p>Let's say we want to create a two variable truth table. A table with two columns for the two variables would look like this:</p>
<div class="language-Python highlight"><span class="filename">Table instantiation</span><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">ReportTable</span><span class="p">((</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="n">heading</span><span class="o">=</span><span class="s2">&quot;Two variable truth table&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>At this point, we could add this table instance into the table list in our report, but we would only get the table header (the first row), because we haven't actually added any data to it yet.</p>
<p>We have two options when it comes to adding rows, an implicit function (<code>add_row_impl()</code>) and an explicit function (<code>add_row_expl()</code>). If not enough cells in a row is provided to match the number of columns, empty cells are rendered in instead.</p>
<dl>
<dt><code>add_row_impl()</code></dt>
<dd>
<p>This function takes in an arbitrary number of cells.</p>
</dd>
<dt><code>add_row_expl()</code></dt>
<dd>
<p>This function expects an instance of <code>ReportTableRow</code>.</p>
</dd>
</dl>
<p><div class="language-Python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">class</span> <span class="nc">MyReportView</span><span class="p">(</span><span class="n">ReportView</span><span class="p">):</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>    <span class="n">headline</span> <span class="o">=</span> <span class="s1">&#39;My fancy report&#39;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="k">def</span> <span class="nf">get_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>        <span class="n">truth_table</span> <span class="o">=</span> <span class="n">ReportTable</span><span class="p">((</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="n">heading</span><span class="o">=</span><span class="s2">&quot;Two variable truth table&quot;</span><span class="p">)</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>        <span class="n">truth_table</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span><span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>        <span class="n">truth_table</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span><span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span> <span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">))</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="n">truth_table</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span><span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>        <span class="n">truth_table</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span><span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">),</span> <span class="n">ReportTableCell</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">))</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">truth_table</span><span class="p">]</span>
</span></code></pre></div>
<img alt="Truth table example" src="../truth_table.png" /></p>
<h2 id="production-example-1">Production example 1</h2>
<p>So that we can understand the system more, let's make reports that are already built and in production. This report will consist of a singular table where each row represents a single '<em>jednotka</em>' and each column an important property of each instance.</p>
<p>The columns required are the following:</p>
<ul>
<li>Číslo jednotky</li>
<li>Typ</li>
<li>Kontakty</li>
<li>Variabilní symbol jednotky</li>
<li>Patro</li>
<li>Plocha (v m<sup>2</sup>)</li>
<li>Podíl</li>
<li>Počet osob</li>
<li>Volitelné služby</li>
<li>Předpis záloh</li>
</ul>
<div class="language-Python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">class</span> <span class="nc">SestavaByty</span><span class="p">(</span><span class="n">DumReportView</span><span class="p">):</span> <span class="c1"># (1)!</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Sestava jednotky&#39;</span> <span class="c1"># (2)!</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="k">def</span> <span class="nf">get_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>        <span class="n">table</span> <span class="o">=</span> <span class="n">ReportTable</span><span class="p">((</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>            <span class="s1">&#39;Jednotka&lt;br&gt;(číslo)&#39;</span><span class="p">,</span> <span class="s1">&#39;Typ&#39;</span><span class="p">,</span> <span class="s1">&#39;Kontakty&#39;</span><span class="p">,</span> <span class="s1">&#39;Jednotka&lt;br&gt;(VS)&#39;</span><span class="p">,</span> <span class="s1">&#39;Patro&#39;</span><span class="p">,</span> <span class="s1">&#39;Plocha&#39;</span><span class="p">,</span> <span class="s1">&#39;Podíl&#39;</span><span class="p">,</span> <span class="s1">&#39;Počet osob&#39;</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>            <span class="s1">&#39;Volitelné služby&#39;</span><span class="p">,</span> <span class="s1">&#39;Předpis záloh&#39;</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>        <span class="p">),</span> <span class="s1">&#39;Kontrolní sestava jednotky&#39;</span><span class="p">)</span> <span class="c1"># (3)!</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>        <span class="k">for</span> <span class="n">jednotka</span> <span class="ow">in</span> <span class="n">Byty</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">vyber_dum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_referral_dum</span><span class="p">()):</span> <span class="c1"># (4)!</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>            <span class="n">table</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">cislo</span><span class="p">),</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>                <span class="n">ChoiceCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">typ_jednotky</span><span class="p">,</span> <span class="n">TypyJednotek</span><span class="p">),</span> <span class="c1"># (5)!</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>                <span class="n">ReportTableCell</span><span class="p">([</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>                    <span class="p">(</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>                        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">contact</span><span class="o">.</span><span class="n">kontakt</span><span class="si">}</span><span class="s1">*&#39;</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">seznam_kontaktu_report</span><span class="p">,</span> <span class="n">VlastniciQuerySet</span><span class="p">)</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>                        <span class="k">else</span> <span class="n">contact</span><span class="o">.</span><span class="n">kontakt</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>                    <span class="p">)</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>                    <span class="k">for</span> <span class="n">contact</span> <span class="ow">in</span> <span class="n">jednotka</span><span class="o">.</span><span class="n">seznam_kontaktu_report</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>                <span class="p">]),</span> <span class="c1"># (6)!</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">variabilni</span><span class="p">),</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">patro</span><span class="p">),</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">jednotka</span><span class="o">.</span><span class="n">rozloha</span><span class="si">}</span><span class="s1">m&lt;sup&gt;2&lt;/sup&gt;&#39;</span><span class="p">),</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">velikost_podilu_zlomek</span><span class="p">),</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">pocet_osob</span><span class="p">),</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>                <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">pocet_volitelnych_sluzeb</span><span class="p">),</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>                <span class="n">CurrencyCell</span><span class="p">(</span><span class="n">secti_platne_definice_zaloh_byt</span><span class="p">(</span><span class="n">jednotka</span><span class="p">))</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>            <span class="p">)</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>        <span class="k">return</span> <span class="p">[</span><span class="n">table</span><span class="p">]</span>
</span></code></pre></div>
<ol>
<li>We're using the extended version of the base <code>ReportView</code>, because it has convenient features tailored to reports that have anything to do with '<em>Domy</em>' of '<em>Byty</em>'.</li>
<li>Setting the page title to '<em>Sestava jednotky</em>'.</li>
<li>Report table instantiation. Passing in a tuple of column names and a table heading.</li>
<li>Iterating over all the <em>jednotky</em> and adding a row to the table for each one.</li>
<li>Property <code>jednotka.typ_jednotky</code> returns either 'A' or 'B'. The <code>TypyJednotek</code> is a mapping of these two values to their corresponding names. Instead of using the generic <code>ReportTableCell</code> and an if statement, we use the <code>ChoiceCell</code> that is designed for this purpose.</li>
<li>The <code>seznam_kontaktu_report</code> property returns either a <code>VlastniciQuerySet</code> or <code>NajemniciQuerySet</code>. A contact that is a '<em>Vlastnik</em>' needs to have a asterisk attached.</li>
</ol>
<p><img alt="Sestava byty" src="../sestava_byty.png" /></p>
<h2 id="production-example-2">Production example 2</h2>
<p>Let's now take a much more complex report. In this example, we will look at the '<em>Závěrečné vyúčtování služeb</em>'. </p>
<p>It consists of an extra header content, a custom table renderer and <strong>three</strong> tables.</p>
<p>The individual tables are in their separate classes as not to introduce too much clutter in the <code>views.py</code> files.</p>
<div class="language-Python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">class</span> <span class="nc">SestavaZaverecneVyuctovaniSluzeb</span><span class="p">(</span><span class="n">DumReportView</span><span class="p">):</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Závěrečné vyúčtování služeb&#39;</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="n">extra_header</span> <span class="o">=</span> <span class="n">TemplateContent</span><span class="p">(</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>        <span class="s1">&#39;snippets/report_kontrolni_sestava_period_extra_header.html&#39;</span><span class="p">,</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>        <span class="n">sestava</span><span class="o">=</span><span class="s1">&#39;přehled závěrečného vyúčtování služeb&#39;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="p">)</span> <span class="c1"># (1)!</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="n">report_renderer</span> <span class="o">=</span> <span class="s1">&#39;snippets/zaverecne_vyuctovani_sluzeb_report_renderer.html&#39;</span> <span class="c1"># (2)!</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="k">def</span> <span class="nf">get_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>        <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>        <span class="c1"># Tabulka I.</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="n">predpisy_zaloh_table</span> <span class="o">=</span> <span class="n">PrehledZaverecnehoVyuctovaniSluzeb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">referral_dum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vybrany_rok</span><span class="p">)</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>        <span class="c1"># Tabulka II.</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>        <span class="n">vyuctovani_sluzeb_table</span> <span class="o">=</span> <span class="n">DetailniVyuctovaniSluzeb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">referral_dum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vybrany_rok</span><span class="p">)</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>        <span class="c1"># Tabulka III.</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>        <span class="n">summary_table</span> <span class="o">=</span> <span class="n">KonecneSouctySluzeb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">referral_dum</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vybrany_rok</span><span class="p">,</span> <span class="n">predpisy_zaloh_table</span><span class="o">.</span><span class="n">jednotky_totals</span><span class="p">)</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="n">tables</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">predpisy_zaloh_table</span><span class="p">,</span> <span class="n">vyuctovani_sluzeb_table</span><span class="p">,</span> <span class="n">summary_table</span><span class="p">])</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>        <span class="k">return</span> <span class="n">tables</span>
</span></code></pre></div>
<ol>
<li>A common header extracted into a template extra content. Discussed in a following <a href="#extra-content">section</a>.</li>
<li>A custom renderer used to insert a print-only page break after every table. The renderer code itself can be seen in a codeblock below.</li>
</ol>
<p>The custom renderer, as mentioned, adds a print-only page break after every table, so that the printed report has each paper dedicated to every table.</p>
<div class="language-HTML highlight"><span class="filename">snippets/zaverecne_vyuctovani_sluzeb_report_renderer.html</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>{% extends &#39;snippets/report_renderer.html&#39; %}
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>{% block table_after %}
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>    {{ block.super }}
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    {% if not forloop.last %}
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;print-page-break&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    {% endif %}
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>{% endblock %}
</span></code></pre></div>
<h3 id="extra-content">Extra content</h3>
<p>The view takes advantage of the <code>extra_header</code> property. The <code>TemplateContent</code> is used with the template <code>report_kontrolni_sestava_period_extra_header.html</code>.</p>
<p>The report header is captured on the image below. </p>
<p>The report title (labeled with a <strong>1</strong>) is handled by the <code>DumReportView</code>. It is aware of what '<em>Dum</em>' we are dealing with and using that information it dynamically creates the report title.</p>
<p>The extra content template gets passed a <code>sestava</code> parameter (used in the title labeled with a <strong>2</strong>) and already has access to the year of the report (labeled with a <strong>3</strong>) so using this extra content saves on repeating code.</p>
<p><img alt="Report header" src="../report_header.png" /></p>
<h3 id="individual-tables">Individual tables</h3>
<p>In this section, the source code for the three tables is shown and described. Only the main construction part of the class is shown, because there is no need to show setting the columns, titles, etc.</p>
<div class="language-Python highlight"><span class="filename">PrehledZaverecnehoVyuctovaniSluzeb</span><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">for</span> <span class="n">jednotka</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aktivni_jednotky</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)):</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">sluzby</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>    <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_categories</span><span class="p">:</span> <span class="c1"># (1)!</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>        <span class="n">amount</span> <span class="o">=</span> <span class="n">get_kategorie_zalohy_castka</span><span class="p">(</span><span class="n">jednotka</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_year</span><span class="p">)</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>        <span class="n">sluzby</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CurrencyCell</span><span class="p">(</span><span class="n">amount</span><span class="p">))</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">totals</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_categories</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">category</span><span class="p">)]</span> <span class="o">+=</span> <span class="n">amount</span> <span class="k">if</span> <span class="n">amount</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">0</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>        <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">variabilni</span><span class="p">),</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>        <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">primarni_kontakt</span><span class="p">),</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>        <span class="o">*</span><span class="n">sluzby</span> <span class="c1"># (2)!</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>    <span class="p">)</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="bp">self</span><span class="o">.</span><span class="n">add_row_expl</span><span class="p">(</span><span class="n">ReportTableRow</span><span class="o">.</span><span class="n">total_table_sum_row</span><span class="p">(</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>    <span class="n">EmptyCell</span><span class="p">(),</span> <span class="o">*</span><span class="p">[</span><span class="n">CurrencyCell</span><span class="o">.</span><span class="n">sum_cell</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="k">for</span> <span class="n">total</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">totals</span><span class="p">]</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="p">))</span> <span class="c1"># (3)!</span>
</span></code></pre></div>
<ol>
<li>Compiling the categories.</li>
<li>Adding the cells. Every '<em>jednotka</em>' may have a different amount of cells so there might be empty cells in some columns.</li>
<li>Adding a final summation row. Displays the totals of all the rows summed up.</li>
</ol>
<p><img alt="Table I." src="../table1.png" /></p>
<div class="language-Python highlight"><span class="filename">DetailniVyuctovaniSluzeb</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">totals</span> <span class="o">=</span> <span class="p">{</span><span class="n">index</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sluzba</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sluzby_domu_mimo_fo</span><span class="p">)}</span> <span class="c1"># (1)!</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">for</span> <span class="n">jednotka</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aktivni_jednotky</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)):</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="k">def</span> <span class="nf">handle_sluzba</span><span class="p">(</span><span class="n">sluzba</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>        <span class="n">suma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">soucet_vyuctovani_sluzby_pro_jednotku</span><span class="p">(</span><span class="n">jednotka</span><span class="p">,</span> <span class="n">sluzba</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>        <span class="n">totals</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="n">suma</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>        <span class="k">return</span> <span class="n">suma</span> <span class="k">if</span> <span class="n">suma</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="kc">None</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">variabilni</span><span class="p">),</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="o">*</span><span class="p">[</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>            <span class="n">CurrencyCell</span><span class="p">(</span><span class="n">handle_sluzba</span><span class="p">(</span><span class="n">sluzba_definice</span><span class="p">,</span> <span class="n">index</span><span class="p">))</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>            <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">sluzba_definice</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sluzby_domu_mimo_fo</span><span class="p">)</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>        <span class="p">]</span> <span class="c1"># (2)!</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>    <span class="p">)</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="bp">self</span><span class="o">.</span><span class="n">add_row_expl</span><span class="p">(</span><span class="n">ReportTableRow</span><span class="o">.</span><span class="n">total_table_sum_row</span><span class="p">(</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>    <span class="o">*</span><span class="p">(</span><span class="n">CurrencyCell</span><span class="o">.</span><span class="n">sum_cell</span><span class="p">(</span><span class="n">total</span><span class="p">)</span> <span class="k">for</span> <span class="n">total</span> <span class="ow">in</span> <span class="n">totals</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="p">))</span> <span class="c1"># (3)!</span>
</span></code></pre></div>
<ol>
<li>A dictionary to keep track of totals of '<em>služby</em>' to later display in the last summation row.</li>
<li>The table has a variable amount of columns depending on what sluzby the '<em>Dum</em>' has.</li>
<li>Adding a final summation row. Displays the totals of all the rows summed up.</li>
</ol>
<p><img alt="Table II." src="../table2.png" /></p>
<div class="language-Python highlight"><span class="filename">KonecneSouctySluzeb</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">predpisy_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">platby_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">celkem_total</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="k">for</span> <span class="n">jednotka</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">aktivni_jednotky</span><span class="p">(</span><span class="n">date</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)):</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">sluzby_bez_fo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">soucet_vyuctovani_sluzeb_pro_jednotku</span><span class="p">(</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>        <span class="n">jednotka</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sluzby_domy_mimo_fo</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>    <span class="p">)</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>    <span class="n">predpisy</span> <span class="o">=</span> <span class="n">sluzby_bez_fo</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">jednotky_totals</span><span class="p">[</span><span class="n">jednotka</span><span class="o">.</span><span class="n">variabilni</span><span class="p">]</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>    <span class="n">platby</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jednotka_zaplaceno_na_zalohach</span><span class="p">(</span><span class="n">jednotka</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="n">celkem</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">platby</span> <span class="o">-</span> <span class="n">predpisy</span><span class="p">)</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>    <span class="bp">self</span><span class="o">.</span><span class="n">add_row_impl</span><span class="p">(</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>        <span class="n">ReportTableCell</span><span class="p">(</span><span class="n">jednotka</span><span class="o">.</span><span class="n">variabilni</span><span class="p">),</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>        <span class="n">CurrencyCell</span><span class="p">(</span><span class="n">predpisy</span><span class="p">),</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>        <span class="n">CurrencyCell</span><span class="p">(</span><span class="n">platby</span><span class="p">),</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>        <span class="n">CurrencyCell</span><span class="p">(</span><span class="n">celkem</span><span class="p">)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>    <span class="p">)</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>    <span class="n">predpisy_total</span> <span class="o">+=</span> <span class="n">predpisy</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>    <span class="n">platby_total</span> <span class="o">+=</span> <span class="n">platby</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>    <span class="n">celkem_total</span> <span class="o">+=</span> <span class="n">celkem</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a><span class="bp">self</span><span class="o">.</span><span class="n">add_row_expl</span><span class="p">(</span><span class="n">ReportTableRow</span><span class="o">.</span><span class="n">total_table_sum_row</span><span class="p">(</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>    <span class="n">CurrencyCell</span><span class="o">.</span><span class="n">sum_cell</span><span class="p">(</span><span class="n">predpisy_total</span><span class="p">),</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a>    <span class="n">CurrencyCell</span><span class="o">.</span><span class="n">sum_cell</span><span class="p">(</span><span class="n">platby_total</span><span class="p">),</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>    <span class="n">CurrencyCell</span><span class="o">.</span><span class="n">sum_cell</span><span class="p">(</span><span class="n">celkem_total</span><span class="p">)</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a><span class="p">))</span> <span class="c1"># (1)!</span>
</span></code></pre></div>
<ol>
<li>Adding a final summation row. Displays the totals of all the rows summed up.</li>
</ol>
<p><img alt="Table III." src="../table3.png" /></p>
<p>The final report looks like this:</p>
<p><img alt="Zaverecne vyuctovani sluzeb" src="../zaverecne_vyuctovani_sluzeb.png" /></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../building-blocks/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Building blocks">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Building blocks
              </div>
            </div>
          </a>
        
        
          
          <a href="../../misc/view-template-configuration/" class="md-footer__link md-footer__link--next" aria-label="Next: ViewTemplateConfiguration">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                ViewTemplateConfiguration
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.instant", "content.action.edit", "search.suggest", "search.share", "content.code.copy", "content.code.select", "content.code.annotate", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>